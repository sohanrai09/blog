<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="It&rsquo;s been a while since my first 
  blog post as I mentioned there, I&rsquo;m at a new job (well it&rsquo;s been 2 months, so &rsquo;newish&rsquo;) and I&rsquo;ve been busy getting to know the job(as with any job, there is a LOT to learn!).
Learning 
  Robot Framework (RF) has been one of my objectives in these first few months as that is entirely new for me. As I continue to learn and explore RF, I wanted to take some time out to share few things I have learnt. When it comes to network testing, it&rsquo;s not always about testing features, protocols, it also involves testing the hardware components. In this blog post, I want to discuss one such test scenario. This particular Test scenario would be to restart a FPC numerous times and to check and ensure it comes back up to Online state. This is what we call a Negative Trigger Event Testing. Now imagine having to do this manually, needless to say it&rsquo;s a time consuming task, this is where RF comes into play."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://sohanrai09.github.io/blog/posts/robotframework-2/"><meta property="og:site_name" content="Sohan’s blog"><meta property="og:title" content="Robotframework 2"><meta property="og:description" content="It’s been a while since my first blog post as I mentioned there, I’m at a new job (well it’s been 2 months, so ’newish’) and I’ve been busy getting to know the job(as with any job, there is a LOT to learn!).
Learning Robot Framework (RF) has been one of my objectives in these first few months as that is entirely new for me. As I continue to learn and explore RF, I wanted to take some time out to share few things I have learnt. When it comes to network testing, it’s not always about testing features, protocols, it also involves testing the hardware components. In this blog post, I want to discuss one such test scenario. This particular Test scenario would be to restart a FPC numerous times and to check and ensure it comes back up to Online state. This is what we call a Negative Trigger Event Testing. Now imagine having to do this manually, needless to say it’s a time consuming task, this is where RF comes into play."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-06-10T19:02:18+05:30"><meta property="article:modified_time" content="2022-06-10T19:02:18+05:30"><meta property="article:tag" content="Robotframework"><title>Robotframework 2 | Sohan’s blog</title>
<link rel=icon href=/blog/favicon.png><link rel=manifest href=/blog/manifest.json><link rel=canonical href=https://sohanrai09.github.io/blog/posts/robotframework-2/><link rel=stylesheet href=/blog/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/blog/fuse.min.js></script><script defer src=/blog/en.search.min.bc7a453251a63831ad73b025b31e0afdf9209657676dc634e71cf07fdde9a58e.js integrity="sha256-vHpFMlGmODGtc7Alsx4K/fkglldnbcY05xzwf93ppY4=" crossorigin=anonymous></script><script defer src=/blog/sw.min.f4bc4151631c92d29816d24dfaacb947aa6b03f91ec1c0cd2738ba8957d04791.js integrity="sha256-9LxBUWMcktKYFtJN+qy5R6prA/kewcDNJzi6iVfQR5E=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/blog/><span>Sohan’s blog</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=https://github.com/sohanrai09 target=_blank rel=noopener>Github</a></li><li><a href=https://sohanrai09.github.io/blog/posts target=_blank rel=noopener>Posts</a></li><li><a href=https://twitter.com/SohanRai23 target=_blank rel=noopener>Twitter</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/blog/svg/menu.svg class=book-icon alt=Menu></label><h3>Robotframework 2</h3><label for=toc-control><img src=/blog/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><ul><li><a href=#varibalesyaml>varibales.yaml</a></li><li><a href=#utilitiespy>utilities.py</a></li><li><a href=#test-suite>Test Suite</a></li><li><a href=#execution>Execution</a></li><li><a href=#conclusion>Conclusion</a></li></ul></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2>Robotframework 2</h2><div class="flex align-center text-small book-post-date"><img src=/blog/svg/calendar.svg class=book-icon alt>
<span>Jun 10, 2022</span></div><div class=text-small><a href=/blog/categories/robotframework/>Robotframework</a></div><div class=text-small><a href=/blog/tags/robotframework/>Robotframework</a></div><div class=book-post-content><p>It&rsquo;s been a while since my first
<a href=https://sohanrai09.github.io/new-blog/2022/04/robot-framework-1/>blog post</a> as I mentioned there, I&rsquo;m at a new job (well it&rsquo;s been 2 months, so &rsquo;newish&rsquo;) and I&rsquo;ve been busy getting to know the job(as with any job, there is a LOT to learn!).</p><p>Learning
<a href=https://robotframework.org/>Robot Framework</a> (RF) has been one of my objectives in these first few months as that is entirely new for me. As I continue to learn and explore RF, I wanted to take some time out to share few things I have learnt. When it comes to network testing, it&rsquo;s not always about testing features, protocols, it also involves testing the hardware components. In this blog post, I want to discuss one such test scenario. This particular Test scenario would be to restart a FPC numerous times and to check and ensure it comes back up to Online state. This is what we call a <code>Negative Trigger Event</code> Testing. Now imagine having to do this manually, needless to say it&rsquo;s a time consuming task, this is where RF comes into play.</p><p>In this post, I will only explain anything new I&rsquo;m using in RF as compared to my first
<a href=https://sohanrai09.github.io/new-blog/2022/04/robot-framework-1/>blog post</a>.</p><h3 id=varibalesyaml>varibales.yaml
<a class=anchor href=#varibalesyaml>#</a></h3><p>In this post, I will be using a yaml file to input the variables rather than encoding them directly in the Test Suite file. We define the variables in a yaml file, like shown below, and access them as dictionaries in the Test Suite file.</p><pre tabindex=0><code>VARS:
  host: 192.168.1.1  #Device under testing
  fpc: 3  #FPC to reboot
</code></pre><p>With this variable file, we can access the <code>host</code> value as <code>${VARS.host}</code> and similarly <code>fpc</code> value as <code>${VARS.fpc}</code>.</p><h3 id=utilitiespy>utilities.py
<a class=anchor href=#utilitiespy>#</a></h3><p>As mentioned in my previous post, any <code>Keywords</code> needed for Test execution will be defined in a Python script as <code>functions</code>. For this Test Case, I have defined two functions, one to check and return the state of the FPC and another one to trigger the FPC restart event, see below.</p><pre tabindex=0><code>from jnpr.junos import Device

def fpc_restart(host,fpc):
    &#39;&#39;&#39;
    Function to restart the FPC
    &#39;&#39;&#39;
    dev = Device(host=host, user=&#39;user&#39;, password=&#39;password&#39;)
    dev.open()
    dev.rpc.request_chassis_fpc(slot=str(fpc),restart=True)

def fpc_state(host,fpc):
    &#39;&#39;&#39;
    Function to check the FPC status
    &#39;&#39;&#39;
    dev = Device(host=host, user=&#39;user&#39;, password=&#39;password&#39;)
    dev.open()
    fpc_state_cli = dev.rpc.get_fpc_information().findtext(f&#34;./fpc[slot=&#39;{fpc}&#39;]/state&#34;)
    return fpc_state_cli
</code></pre><p>I&rsquo;m using Juniper&rsquo;s PyEz library here as the RPC based options it provides are quite handy than CLI scraping. If you are new to PyEz, you can check out my
<a href=https://github.com/sohanrai09/my_PyEz>Github repo</a> where I&rsquo;ve explained how to get started with PyEz and you can also find few basic scripts.</p><h3 id=test-suite>Test Suite
<a class=anchor href=#test-suite>#</a></h3><p>Now let&rsquo;s look at the Test Suite itself, bit by bit. First, the <code>Settings</code> section. Here we define the Library file, which is where we have our Keywords defined and also Variable file, which is where we have the Variables in yaml.</p><pre tabindex=0><code>*** Settings ***
Library    utilities.py
Variables    variables.yaml
</code></pre><p>Next we look at the Test Case</p><pre tabindex=0><code>*** Test Cases ***
TC - 1 Restart FPC
    [Documentation]    Test Case to reboot the given FPC
    FOR  ${i}    IN RANGE    2  # i = 0, 1
        Log To Console    \n~~~ Checking FPC State ~~~
        ${fpc_state} =    FPC State   ${VARS.host}    ${VARS.fpc}
        
        Run Keyword If    &#39;${fpc_state}&#39; == &#39;Online&#39;    Log To Console    \n~~~ FPC ${VARS.fpc} is Online\nProceeding with restart ~~~
        ...    ELSE    Fail    \n~~~ FPC ${VARS.fpc} is ${fpc_state},please recheck ~~~
        Run Keyword If    &#39;${fpc_state}&#39; == &#39;Online&#39;    FPC Restart    ${VARS.host}     ${VARS.fpc}
        Sleep    300s

        Log To Console    \n~~~ Checking FPC State after restart ~~~
        ${fpc_state} =    FPC State    ${VARS.host}     ${VARS.fpc}
        Run Keyword If    &#39;${fpc_state}&#39; == &#39;Online&#39;    Log To Console    \n~~~ FPC is back Online! ~~~
        Log To Console    \n~~~ Iteration ${i} completed ~~~
    END
</code></pre><p>There seems to be a LOT going on here but if you look at it closely, there actually isn&rsquo;t. Going past the <code>Documentation</code> field, we see a FOR LOOP. To anyone familiar with programming, this is nothing new, all you need to worry about is the syntax. I always refer to the official
<a href=https://robotframework.org/robotframework/latest/RobotFrameworkUserGuide.html#>user guide</a> to understand the syntax and usage. In our Test Case, number of iterations are 2, which means we will be &lsquo;restarting&rsquo; the given FPC 2 times.</p><p><code>Log To Console</code> is a builtin Keyword RF offers, which as it says is to print something to the console. Again, I refer to the official
<a href=https://robotframework.org/robotframework/latest/libraries/BuiltIn.html#>documentation</a> for this, here you can explore various builtin Keywords available for you to work with.</p><p>Next, we see our first Keyword (user defined) coming into play.</p><pre tabindex=0><code>${fpc_state} =    FPC State   ${VARS.host}    ${VARS.fpc}

Run Keyword If    &#39;${fpc_state}&#39; == &#39;Online&#39;    Log To Console    \n~~~ FPC ${VARS.fpc} is Online\nProceeding with restart ~~~
...    ELSE    Fail    \n~~~ FPC ${VARS.fpc} is ${fpc_state},please recheck ~~~
</code></pre><p>Here we are invoking a Keyword <code>FPC State</code>, which is nothing but the <code>fpc_state(host,fpc)</code> function we defined in the utilities.py file, and passing in the variables <code>${VARS.host}</code> and <code>${VARS.fpc}</code>. &lsquo;return&rsquo; value from the function/Keyword is then stored in a variable <code>${fpc_state}</code>.</p><p>Then we see another inbuilt Keyword, <code>Run Keyword If</code>, which as it says, would run a Keyword if a particular condition is met. Condition in our case is if the output returned from the FPC State function is Online or not. If our condition is met (or in other words &lsquo;True&rsquo;) then we execute a Keyword <code>Log To Console</code>, which as explained before would log a message that the FPC we are checking is Online and that we are proceeding with restarting it. But if our condition FAILs, we have a ELSE clause to take care of that. If the ELSE clause is hit, we will first and foremast FAIL our Test Case, that is why we have used another builtin Keyword <code>FAIL</code> and we can also print a message to Console as to why we are failing the Test Case, neat isn&rsquo;t it? Note, if you are wondering what the <code>...</code> signifies, it is used when you want to continue the code on next line, so as to not over extend the same line.</p><p>Continuing further, we are now invoking our next function/Keyword but only when our condition is met! Condition is still the same one we looked at above!</p><pre tabindex=0><code>Run Keyword If    &#39;${fpc_state}&#39; == &#39;Online&#39;    FPC Restart    ${VARS.host}     ${VARS.fpc}
Sleep    300s
</code></pre><p>Same 2 variables are passed to <code>FPC Restart</code> Keyword as well. <code>Sleep</code> as you would have guessed it, is a builtin Keyword to, there is no better way to put it, sleep.</p><p>Next section is failry simple as we now check the FPC State again (after 300s remember) to ensure it has come back Online.</p><pre tabindex=0><code>Log To Console    \n~~~ Checking FPC State after restart ~~~
${fpc_state} =    FPC State    ${VARS.host}     ${VARS.fpc}
Run Keyword If    &#39;${fpc_state}&#39; == &#39;Online&#39;    Log To Console    \n~~~ FPC is back Online! ~~~
Log To Console    \n~~~ Iteration ${i} completed ~~~
</code></pre><p>The whole process will be repeated as a part of our <code>FOR LOOP</code>, in this case, twice.</p><h3 id=execution>Execution
<a class=anchor href=#execution>#</a></h3><pre tabindex=0><code>(personal_env) sohanr@sohanr-mbp:~/envs$ robot fpc_reboot.robot 
==============================================================================
Fpc Reboot                                                                    
==============================================================================
TC - 1 Restart FPC :: Test Case to reboot the given FPC               
~~~ Checking FPC State ~~~

~~~ FPC 3 is Online
Proceeding with restart ~~~

~~~ Checking FPC State after restart ~~~

~~~ FPC is back Online! ~~~

~~~ Iteration 0 completed ~~~

~~~ Checking FPC State ~~~

~~~ FPC 3 is Online
Proceeding with restart ~~~

~~~ Checking FPC State after restart ~~~

~~~ FPC is back Online! ~~~

~~~ Iteration 1 completed ~~~
TC - 1 Restart FPC :: Test Case to reboot the given FPC               | PASS |
------------------------------------------------------------------------------
Fpc Reboot                                                            | PASS |
1 test, 1 passed, 0 failed
==============================================================================
Output:  /homes/sohanr/envs/output.xml
Log:     /homes/sohanr/envs/log.html
Report:  /homes/sohanr/envs/report.html
(personal_env) sohanr@sohanr-mbp:~/envs$ 
</code></pre><p>I&rsquo;m hoping the output is self explaintory, as always with RF, we get the Log and Report in html format which makes viewing it really easy.</p><p>Also to just show a <code>FAIL</code> scenario, I will provide a FPC slot which is not in use and let&rsquo;s see the output for it.</p><pre tabindex=0><code>(personal_env) sohanr@sohanr-mbp:~/envs$ robot fpc_reboot.robot 
==============================================================================
Fpc Reboot                                                                    
==============================================================================
TC - 1 Restart FPC :: Test Case to reboot the given FPC               
~~~ Checking FPC State ~~~
TC - 1 Restart FPC :: Test Case to reboot the given FPC               | FAIL |
~~~ FPC 2 is Empty,please recheck ~~~
------------------------------------------------------------------------------
Fpc Reboot                                                            | FAIL |
1 test, 0 passed, 1 failed
==============================================================================
Output:  /homes/sohanr/envs/output.xml
Log:     /homes/sohanr/envs/log.html
Report:  /homes/sohanr/envs/report.html
(personal_env) sohanr@sohanr-mbp:~/envs$ 
</code></pre><h3 id=conclusion>Conclusion
<a class=anchor href=#conclusion>#</a></h3><p>As you might have seen with this post and the previous one, working with Robot Framework is fairly easy as the Keywords are in plain English and they do exactly what they say! I hope this blog post has been informative, as always please feel to reach out to me with any feedback/comments.</p></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/alex-shpak/hugo-book/edit/master/exampleSite/content/posts/robotframework-2.md target=_blank rel=noopener><img src=/blog/svg/edit.svg class=book-icon alt>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><ul><li><a href=#varibalesyaml>varibales.yaml</a></li><li><a href=#utilitiespy>utilities.py</a></li><li><a href=#test-suite>Test Suite</a></li><li><a href=#execution>Execution</a></li><li><a href=#conclusion>Conclusion</a></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>